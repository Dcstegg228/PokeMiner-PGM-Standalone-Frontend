{"version":3,"sources":["../../js/map.js"],"names":["$selectExclude","$selectPokemonNotify","$selectRarityNotify","$textPerfectionNotify","$selectStyle","$selectIconResolution","$selectIconSize","$selectLuredPokestopsOnly","$selectSearchIconMarker","$selectGymMarkerStyle","$selectLocationIconMarker","$switchGymSidebar","language","document","documentElement","lang","idToPokemon","i8lnDictionary","languageLookups","languageLookupThreshold","searchMarkerStyles","timestamp","excludedPokemon","notifiedPokemon","notifiedRarity","notifiedMinPerfection","buffer","reincludedPokemon","reids","map","rawDataIsLoading","locationMarker","rangeMarkers","searchMarker","storeZoom","scanPath","moves","oSwLat","oSwLng","oNeLat","oNeLng","lastpokestops","lastgyms","lastpokemon","lastslocs","lastspawns","selectedStyle","updateWorker","lastUpdateTime","gymTypes","gymPrestige","audio","Audio","excludePokemon","id","val","concat","trigger","notifyAboutPokemon","removePokemonMarker","encounterId","mapData","pokemons","marker","rangeCircle","setMap","hidden","initMap","google","maps","Map","getElementById","center","lat","centerLat","lng","centerLng","zoom","Store","get","fullscreenControl","streetViewControl","mapTypeControl","clickableIcons","mapTypeControlOptions","style","MapTypeControlStyle","DROPDOWN_MENU","position","ControlPosition","RIGHT_TOP","mapTypeIds","MapTypeId","ROADMAP","SATELLITE","HYBRID","styleNoLabels","StyledMapType","noLabelsStyle","name","mapTypes","set","styleDark","darkStyle","styleLight2","light2Style","stylePgo","pGoStyle","styleDarkNl","darkStyleNoLabels","styleLight2Nl","light2StyleNoLabels","stylePgoNl","pGoStyleNoLabels","stylePgoDay","pGoStyleDay","stylePgoNight","pGoStyleNight","currentDate","Date","currentHour","getHours","stylePgoDynamic","addListener","s","mapTypeId","setMapTypeId","updateMap","getZoom","redrawPokemon","lurePokemons","createSearchMarker","createLocationMarker","createMyLocationButton","initSidebar","$","on","loc","getCenter","changeLocation","checked","prop","searchControl","updateLocationMarker","setIcon","icon","Marker","animation","Animation","DROP","draggable","optimized","zIndex","MAX_ZINDEX","infoWindow","InfoWindow","content","disableAutoPan","addListeners","event","newLocation","getPosition","updateSearchMarker","oldLocation","changeSearchLocation","done","fail","setPosition","searchControlURI","action","post","encodeURIComponent","toggleClass","updateSearchStatus","getJSON","then","data","status","toggle","searchBox","places","Autocomplete","css","setInterval","place","getPlace","geometry","location","icons","each","pokemonSprites","key","value","append","attr","text","pad","number","slice","getTypeSpan","type","openMapDirections","myLocation","url","window","open","pokemonLabel","rarity","types","disappearTime","latitude","longitude","atk","def","sta","move1","move2","disappearDate","rarityDisplay","typesDisplay","index","details","iv","toFixed","i8ln","contentstring","getMinutes","getSeconds","gymLabel","teamName","teamId","gymPoints","lastScanned","members","gymId","memberStr","i","length","pokemon_name","trainer_name","trainer_level","pokemon_id","pokemon_cp","lastScannedStr","lastScannedDate","getFullYear","getMonth","getDate","directionsStr","nameStr","gymColor","str","gymLevel","getGymLevel","points","level","pokestopLabel","expireTime","expireDate","formatSpawnTime","seconds","Math","floor","substr","spawnpointLabel","item","time","special","addRangeCircle","targetmap","circleCenter","LatLng","gymColors","teamColor","range","circleColor","rangeCircleOpts","radius","strokeWeight","strokeColor","strokeOpacity","fillColor","fillOpacity","Circle","isRangeActive","customizePokemonMarker","skipNotification","setAnimation","animationDisabled","indexOf","play","sendNotification","BOUNCE","perfection","setupGymMarker","scaledSize","Size","gymSidebar","querySelector","getAttribute","classList","contains","remove","setAttribute","showGymDetails","persist","clearSelection","updateLabelDiffTime","close","updateGymMarker","setContent","updateGymIcons","gyms","setupPokestopMarker","imagename","getColorByDate","diff","now","hue","toString","join","setupScannedMarker","clickable","getColorBySpawnTime","round","changeSpawnIcon","color","urlColor","zoomScale","minimumSize","newSize","newIcon","anchor","Point","spawnPointIndex","newIndex","scale","setupSpawnpointMarker","selection","empty","getSelection","removeAllRanges","infoWindowIsOpen","clearStaleMarkers","getTime","scanned","showInBoundsMarkers","markers","show","getBounds","intersects","team_id","getMap","oldAnimation","getAnimation","loadRawData","loadPokemon","loadGyms","loadPokestops","loadScanned","loadSpawnpoints","loadLuredOnly","Boolean","bounds","swPoint","getSouthWest","nePoint","getNorthEast","swLat","swLng","neLat","neLng","ajax","String","dataType","cache","beforeSend","complete","processPokemons","setupPokemonMarker","processPokestops","pokestops","item2","updatePokestops","removeStops","currentTime","push","processGyms","processScanned","scanId","last_modified","updateScanned","setOptions","processSpawnpoints","spawnpoints","updateSpawnPoints","setZIndex","result","hasClass","countMarkers","Array","filter","e","drawScanPath","scanPathPoints","idx","point","Polyline","path","geodesic","pokemonList","newMarker","element","disappearsAt","parseInt","difference","abs","hours","minutes","timestring","getPointDistance","pointA","pointB","spherical","computeDistanceBetween","title","Notification","permission","requestPermission","notification","body","sound","onclick","focus","centerMap","locationContainer","createElement","locationButton","backgroundColor","border","outline","width","height","borderRadius","boxShadow","cursor","marginRight","padding","appendChild","locationIcon","margin","backgroundImage","backgroundSize","backgroundPosition","backgroundRepeat","addEventListener","centerMapOnLocation","controls","RIGHT_BOTTOM","currentLocation","imgX","animationInterval","navigator","geolocation","getCurrentPosition","latlng","coords","setCenter","clearInterval","setZoom","word","isEmptyObject","async","success","error","jqXHR","console","log","updateGeoLocation","panTo","createUpdateWorker","isMobileDevice","Worker","updateBlob","Blob","updateBlobURL","URL","createObjectURL","onmessage","postMessage","ex","message","sidebar","sidebarClose","add","gym_points","nextLvlPrestige","prestigePercentage","last_scanned","freeSlots","pokemon","freeSlotsStr","gymLevelStr","pokemonHtml","headerHtml","perfectPercent","iv_defense","iv_attack","iv_stamina","moveEnergy","move_2_energy","move_1_name","move_1_type","toLowerCase","move_1_damage","move_2_name","move_2_type","move_2_damage","guard_pokemon_id","guard_pokemon_name","innerHTML","href","className","tabIndex","preventDefault","stopPropagation","toggleGymPokemonDetails","lastElementChild","firstElementChild","nextElementSibling","styleList","select2","placeholder","minimumResultsForSearch","Infinity","d","dType","searchMarkerStyleList","selectSearchIconMarker","formatState","state","$state","numberOfPokemon","pokeList","_types","pokemonType","templateResult","Number","isNaN","isTouchDevice","buildSwitchChangeListener","storageKey","change","options","wrapper","hide","bind","setDraggable","alert","accordion","active","collapsible","heightStyle","DataTable","paging","searching","info","errMode","order"],"mappings":"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","file":"map.built.js","sourcesContent":["//\n// Global map.js variables\n//\n\nvar $selectExclude\nvar $selectPokemonNotify\nvar $selectRarityNotify\nvar $textPerfectionNotify\nvar $selectStyle\nvar $selectIconResolution\nvar $selectIconSize\nvar $selectLuredPokestopsOnly\nvar $selectSearchIconMarker\nvar $selectGymMarkerStyle\nvar $selectLocationIconMarker\nvar $switchGymSidebar\n\nvar language = document.documentElement.lang === '' ? 'en' : document.documentElement.lang\nvar idToPokemon = {}\nvar i8lnDictionary = {}\nvar languageLookups = 0\nvar languageLookupThreshold = 3\n\nvar searchMarkerStyles\n\nvar timestamp\nvar excludedPokemon = []\nvar notifiedPokemon = []\nvar notifiedRarity = []\nvar notifiedMinPerfection = null\n\nvar buffer = []\nvar reincludedPokemon = []\nvar reids = []\n\nvar map\nvar rawDataIsLoading = false\nvar locationMarker\nvar rangeMarkers = ['pokemon', 'pokestop', 'gym']\nvar searchMarker\nvar storeZoom = true\nvar scanPath\nvar moves\n\nvar oSwLat\nvar oSwLng\nvar oNeLat\nvar oNeLng\n\nvar lastpokestops\nvar lastgyms\nvar lastpokemon\nvar lastslocs\nvar lastspawns\n\nvar selectedStyle = 'light'\n\nvar updateWorker\nvar lastUpdateTime\n\nvar gymTypes = ['Uncontested', 'Mystic', 'Valor', 'Instinct']\nvar gymPrestige = [2000, 4000, 8000, 12000, 16000, 20000, 30000, 40000, 50000]\nvar audio = new Audio('https://pokepro.co/wp-content/themes/html5blank-stable/static/sounds/ding.mp3')\n\n//\n// Functions\n//\n\nfunction excludePokemon (id) { // eslint-disable-line no-unused-vars\n  $selectExclude.val(\n    $selectExclude.val().concat(id)\n  ).trigger('change')\n}\n\nfunction notifyAboutPokemon (id) { // eslint-disable-line no-unused-vars\n  $selectPokemonNotify.val(\n    $selectPokemonNotify.val().concat(id)\n  ).trigger('change')\n}\n\nfunction removePokemonMarker (encounterId) { // eslint-disable-line no-unused-vars\n  if (mapData.pokemons[encounterId].marker.rangeCircle) {\n    mapData.pokemons[encounterId].marker.rangeCircle.setMap(null)\n    delete mapData.pokemons[encounterId].marker.rangeCircle\n  }\n  mapData.pokemons[encounterId].marker.setMap(null)\n  mapData.pokemons[encounterId].hidden = true\n}\n\nfunction initMap () { // eslint-disable-line no-unused-vars\n  map = new google.maps.Map(document.getElementById('map'), {\n    center: {\n      lat: centerLat,\n      lng: centerLng\n    },\n    zoom: Store.get('zoomLevel'),\n    fullscreenControl: true,\n    streetViewControl: false,\n    mapTypeControl: false,\n    clickableIcons: false,\n    mapTypeControlOptions: {\n      style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,\n      position: google.maps.ControlPosition.RIGHT_TOP,\n      mapTypeIds: [\n        google.maps.MapTypeId.ROADMAP,\n        google.maps.MapTypeId.SATELLITE,\n        google.maps.MapTypeId.HYBRID,\n        'nolabels_style',\n        'dark_style',\n        'style_light2',\n        'style_pgo',\n        'dark_style_nl',\n        'style_light2_nl',\n        'style_pgo_nl',\n        'style_pgo_day',\n        'style_pgo_night',\n        'style_pgo_dynamic'\n      ]\n    }\n  })\n\n  var styleNoLabels = new google.maps.StyledMapType(noLabelsStyle, {\n    name: 'No Labels'\n  })\n  map.mapTypes.set('nolabels_style', styleNoLabels)\n\n  var styleDark = new google.maps.StyledMapType(darkStyle, {\n    name: 'Dark'\n  })\n  map.mapTypes.set('dark_style', styleDark)\n\n  var styleLight2 = new google.maps.StyledMapType(light2Style, {\n    name: 'Light2'\n  })\n  map.mapTypes.set('style_light2', styleLight2)\n\n  var stylePgo = new google.maps.StyledMapType(pGoStyle, {\n    name: 'PokemonGo'\n  })\n  map.mapTypes.set('style_pgo', stylePgo)\n\n  var styleDarkNl = new google.maps.StyledMapType(darkStyleNoLabels, {\n    name: 'Dark (No Labels)'\n  })\n  map.mapTypes.set('dark_style_nl', styleDarkNl)\n\n  var styleLight2Nl = new google.maps.StyledMapType(light2StyleNoLabels, {\n    name: 'Light2 (No Labels)'\n  })\n  map.mapTypes.set('style_light2_nl', styleLight2Nl)\n\n  var stylePgoNl = new google.maps.StyledMapType(pGoStyleNoLabels, {\n    name: 'PokemonGo (No Labels)'\n  })\n  map.mapTypes.set('style_pgo_nl', stylePgoNl)\n\n  var stylePgoDay = new google.maps.StyledMapType(pGoStyleDay, {\n    name: 'PokemonGo Day'\n  })\n  map.mapTypes.set('style_pgo_day', stylePgoDay)\n\n  var stylePgoNight = new google.maps.StyledMapType(pGoStyleNight, {\n    name: 'PokemonGo Night'\n  })\n  map.mapTypes.set('style_pgo_night', stylePgoNight)\n\n  // dynamic map style chooses stylePgoDay or stylePgoNight depending on client time\n  var currentDate = new Date()\n  var currentHour = currentDate.getHours()\n  var stylePgoDynamic = (currentHour >= 6 && currentHour < 19) ? stylePgoDay : stylePgoNight\n  map.mapTypes.set('style_pgo_dynamic', stylePgoDynamic)\n\n  map.addListener('maptypeid_changed', function (s) {\n    Store.set('map_style', this.mapTypeId)\n  })\n\n  map.setMapTypeId(Store.get('map_style'))\n  map.addListener('idle', updateMap)\n\n  map.addListener('zoom_changed', function () {\n    if (storeZoom === true) {\n      Store.set('zoomLevel', this.getZoom())\n    } else {\n      storeZoom = true\n    }\n\n    redrawPokemon(mapData.pokemons)\n    redrawPokemon(mapData.lurePokemons)\n  })\n\n  searchMarker = createSearchMarker()\n  locationMarker = createLocationMarker()\n  createMyLocationButton()\n  initSidebar()\n\n  $('#scan-here').on('click', function () {\n    var loc = map.getCenter()\n    changeLocation(loc.lat(), loc.lng())\n\n    if (!$('#search-switch').checked) {\n      $('#search-switch').prop('checked', true)\n      searchControl('on')\n    }\n  })\n}\n\nfunction updateLocationMarker (style) {\n  if (style in searchMarkerStyles) {\n    locationMarker.setIcon(searchMarkerStyles[style].icon)\n    Store.set('locationMarkerStyle', style)\n  }\n  return locationMarker\n}\n\nfunction createLocationMarker () {\n  var position = Store.get('followMyLocationPosition')\n  var lat = ('lat' in position) ? position.lat : centerLat\n  var lng = ('lng' in position) ? position.lng : centerLng\n\n  var locationMarker = new google.maps.Marker({\n    map: map,\n    animation: google.maps.Animation.DROP,\n    position: {\n      lat: lat,\n      lng: lng\n    },\n    draggable: true,\n    icon: null,\n    optimized: false,\n    zIndex: google.maps.Marker.MAX_ZINDEX + 2\n  })\n\n  locationMarker.infoWindow = new google.maps.InfoWindow({\n    content: '<div><b>My Location</b></div>',\n    disableAutoPan: true\n  })\n\n  addListeners(locationMarker)\n\n  google.maps.event.addListener(locationMarker, 'dragend', function () {\n    var newLocation = locationMarker.getPosition()\n    Store.set('followMyLocationPosition', { lat: newLocation.lat(), lng: newLocation.lng() })\n  })\n\n  return locationMarker\n}\n\nfunction updateSearchMarker (style) {\n  if (style in searchMarkerStyles) {\n    searchMarker.setIcon(searchMarkerStyles[style].icon)\n    Store.set('searchMarkerStyle', style)\n  }\n\n  return searchMarker\n}\n\nfunction createSearchMarker () {\n  var searchMarker = new google.maps.Marker({ // need to keep reference.\n    position: {\n      lat: centerLat,\n      lng: centerLng\n    },\n    map: map,\n    animation: google.maps.Animation.DROP,\n    draggable: !Store.get('lockMarker'),\n    icon: null,\n    optimized: false,\n    zIndex: google.maps.Marker.MAX_ZINDEX + 1\n  })\n\n  searchMarker.infoWindow = new google.maps.InfoWindow({\n    content: '<div><b>Search Location</b></div>',\n    disableAutoPan: true\n  })\n\n  addListeners(searchMarker)\n\n  var oldLocation = null\n  google.maps.event.addListener(searchMarker, 'dragstart', function () {\n    oldLocation = searchMarker.getPosition()\n  })\n\n  google.maps.event.addListener(searchMarker, 'dragend', function () {\n    var newLocation = searchMarker.getPosition()\n    changeSearchLocation(newLocation.lat(), newLocation.lng())\n      .done(function () {\n        oldLocation = null\n      })\n      .fail(function () {\n        if (oldLocation) {\n          searchMarker.setPosition(oldLocation)\n        }\n      })\n  })\n\n  return searchMarker\n}\n\nvar searchControlURI = 'search_control'\nfunction searchControl (action) {\n  $.post(searchControlURI + '?action=' + encodeURIComponent(action))\n  $('#scan-here').toggleClass('disabled', action === 'off')\n}\nfunction updateSearchStatus () {\n  $.getJSON(searchControlURI).then(function (data) {\n    $('#search-switch').prop('checked', data.status)\n    $('#scan-here').toggleClass('disabled', !data.status)\n  })\n}\n\nfunction initSidebar () {\n  $('#gyms-switch').prop('checked', Store.get('showGyms'))\n  $('#gym-sidebar-switch').prop('checked', Store.get('useGymSidebar'))\n  $('#gym-sidebar-wrapper').toggle(Store.get('showGyms'))\n  $('#pokemon-switch').prop('checked', Store.get('showPokemon'))\n  $('#pokestops-switch').prop('checked', Store.get('showPokestops'))\n  $('#lured-pokestops-only-switch').val(Store.get('showLuredPokestopsOnly'))\n  $('#lured-pokestops-only-wrapper').toggle(Store.get('showPokestops'))\n  $('#geoloc-switch').prop('checked', Store.get('geoLocate'))\n  $('#lock-marker-switch').prop('checked', Store.get('lockMarker'))\n  $('#start-at-user-location-switch').prop('checked', Store.get('startAtUserLocation'))\n  $('#follow-my-location-switch').prop('checked', Store.get('followMyLocation'))\n  $('#scan-here-switch').prop('checked', Store.get('scanHere'))\n  $('#scan-here').toggle(Store.get('scanHere'))\n  $('#scanned-switch').prop('checked', Store.get('showScanned'))\n  $('#spawnpoints-switch').prop('checked', Store.get('showSpawnpoints'))\n  $('#ranges-switch').prop('checked', Store.get('showRanges'))\n  $('#sound-switch').prop('checked', Store.get('playSound'))\n  var searchBox = new google.maps.places.Autocomplete(document.getElementById('next-location'))\n  $('#next-location').css('background-color', $('#geoloc-switch').prop('checked') ? '#e0e0e0' : '#ffffff')\n\n  updateSearchStatus()\n  setInterval(updateSearchStatus, 5000)\n\n  searchBox.addListener('place_changed', function () {\n    var place = searchBox.getPlace()\n\n    if (!place.geometry) return\n\n    var loc = place.geometry.location\n    changeLocation(loc.lat(), loc.lng())\n  })\n\n  var icons = $('#pokemon-icons')\n  $.each(pokemonSprites, function (key, value) {\n    icons.append($('<option></option>').attr('value', key).text(value.name))\n  })\n  icons.val((pokemonSprites[Store.get('pokemonIcons')]) ? Store.get('pokemonIcons') : 'highres')\n  $('#pokemon-icon-size').val(Store.get('iconSizeModifier'))\n}\n\nfunction pad (number) {\n  return number <= 99 ? ('0' + number).slice(-2) : number\n}\n\nfunction getTypeSpan (type) {\n  return `<span style='padding: 2px 5px; text-transform: uppercase; color: white; margin-right: 2px; border-radius: 4px; font-size: 0.8em; vertical-align: text-bottom; background-color: ${type['color']}'>${type['type']}</span>`\n}\n\nfunction openMapDirections (lat, lng) { // eslint-disable-line no-unused-vars\n  var myLocation = locationMarker.getPosition()\n  var url = 'https://www.google.com/maps/dir/' + myLocation.lat() + ',' + myLocation.lng() + '/' + lat + ',' + lng\n  window.open(url, '_blank')\n}\n\nfunction pokemonLabel (name, rarity, types, disappearTime, id, latitude, longitude, encounterId, atk, def, sta, move1, move2) {\n  var disappearDate = new Date(disappearTime)\n  var rarityDisplay = rarity ? '(' + rarity + ')' : ''\n  var typesDisplay = ''\n  $.each(types, function (index, type) {\n    typesDisplay += getTypeSpan(type)\n  })\n  var details = ''\n  if (atk != null) {\n    var iv = (atk + def + sta) / 45 * 100\n    details = `\n      <div>\n        IV: ${iv.toFixed(1)}% (${atk}/${def}/${sta})\n      </div>\n      <div>\n        Moves: ${i8ln(moves[move1]['name'])} / ${i8ln(moves[move2]['name'])}\n      </div>\n      `\n  }\n  var contentstring = `\n    <div>\n      <b>${name}</b>\n      <span> - </span>\n      <small>\n        <a href='http://www.pokemon.com/us/pokedex/${id}' target='_blank' title='View in Pokedex'>#${id}</a>\n      </small>\n      <span> ${rarityDisplay}</span>\n      <span> - </span>\n      <small>${typesDisplay}</small>\n    </div>\n    <div>\n      Disappears at ${pad(disappearDate.getHours())}:${pad(disappearDate.getMinutes())}:${pad(disappearDate.getSeconds())}\n      <span class='label-countdown' disappears-at='${disappearTime}'>(00m00s)</span>\n    </div>\n    <div>\n      Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n    </div>\n      ${details}\n    <div>\n      <a href='javascript:excludePokemon(${id})'>Exclude</a>&nbsp;&nbsp\n      <a href='javascript:notifyAboutPokemon(${id})'>Notify</a>&nbsp;&nbsp\n      <a href='javascript:removePokemonMarker(\"${encounterId}\")'>Remove</a>&nbsp;&nbsp\n      <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\n    </div>`\n  return contentstring\n}\n\nfunction gymLabel (teamName, teamId, gymPoints, latitude, longitude, lastScanned = null, name = null, members = [], gymId) {\n  var memberStr = ''\n  for (var i = 0; i < members.length; i++) {\n    memberStr += `\n      <span class=\"gym-member\" title=\"${members[i].pokemon_name} | ${members[i].trainer_name} (Lvl ${members[i].trainer_level})\">\n        <i class=\"pokemon-sprite n${members[i].pokemon_id}\"></i>\n        <span class=\"cp team-${teamId}\">${members[i].pokemon_cp}</span>\n      </span>`\n  }\n\n  var lastScannedStr\n  if (lastScanned) {\n    var lastScannedDate = new Date(lastScanned)\n    lastScannedStr = `${lastScannedDate.getFullYear()}-${pad(lastScannedDate.getMonth() + 1)}-${pad(lastScannedDate.getDate())} ${pad(lastScannedDate.getHours())}:${pad(lastScannedDate.getMinutes())}:${pad(lastScannedDate.getSeconds())}`\n  } else {\n    lastScannedStr = 'Unknown'\n  }\n  var directionsStr = ''\n  if (!Store.get('useGymSidebar')) {\n    directionsStr = `<div>\n        <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\n      </div>`\n  }\n\n  var nameStr = (name ? `<div>${name}</div>` : '')\n\n  var gymColor = ['0, 0, 0, .4', '74, 138, 202, .6', '240, 68, 58, .6', '254, 217, 40, .6']\n  var str\n  if (teamId === 0) {\n    str = `\n      <div>\n        <center>\n          <div>\n            <b style='color:rgba(${gymColor[teamId]})'>${teamName}</b><br>\n            <img height='70px' style='padding: 5px;' src='https://pokepro.co/wp-content/themes/html5blank-stable/static/forts/${teamName}_large.png'>\n          </div>\n          ${nameStr}\n          <div>\n            Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n          </div>\n          <div>\n            Last Scanned: ${lastScannedStr}\n          </div>\n          ${directionsStr}\n        </center>\n      </div>`\n  } else {\n    var gymLevel = getGymLevel(gymPoints)\n    str = `\n      <div>\n        <center>\n          <div style='padding-bottom: 2px'>\n            Gym owned by:\n          </div>\n          <div>\n            <b style='color:rgba(${gymColor[teamId]})'>Team ${teamName}</b><br>\n            <img height='70px' style='padding: 5px;' src='https://pokepro.co/wp-content/themes/html5blank-stable/static/forts/${teamName}_large.png'>\n          </div>\n          <div>\n            ${nameStr}\n          </div>\n          <div>\n            Level: ${gymLevel} | Prestige: ${gymPoints}/${gymPrestige[gymLevel - 1] || 50000}\n          </div>\n          <div>\n            ${memberStr}\n          </div>\n          <div>\n            Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n          </div>\n          <div>\n            Last Scanned: ${lastScannedStr}\n          </div>\n          ${directionsStr}\n        </center>\n      </div>`\n  }\n\n  return str\n}\n\nfunction getGymLevel (points) {\n  var level = 1\n  while (points >= gymPrestige[level - 1]) {\n    level++\n  }\n\n  return level\n}\n\nfunction pokestopLabel (expireTime, latitude, longitude) {\n  var str\n  if (expireTime) {\n    var expireDate = new Date(expireTime)\n\n    str = `\n      <div>\n        <b>Lured Pokéstop</b>\n      </div>\n      <div>\n        Lure expires at ${pad(expireDate.getHours())}:${pad(expireDate.getMinutes())}:${pad(expireDate.getSeconds())}\n        <span class='label-countdown' disappears-at='${expireTime}'>(00m00s)</span>\n      </div>\n      <div>\n        Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n      </div>\n      <div>\n        <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\n      </div>`\n  } else {\n    str = `\n      <div>\n        <b>Pokéstop</b>\n      </div>\n      <div>\n        Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n      </div>\n      <div>\n        <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\n      </div>`\n  }\n\n  return str\n}\n\nfunction formatSpawnTime (seconds) {\n  // the addition and modulo are required here because the db stores when a spawn disappears\n  // the subtraction to get the appearance time will knock seconds under 0 if the spawn happens in the previous hour\n  return ('0' + Math.floor(((seconds + 3600) % 3600) / 60)).substr(-2) + ':' + ('0' + seconds % 60).substr(-2)\n}\nfunction spawnpointLabel (item) {\n  var str = `\n    <div>\n      <b>Spawn Point</b>\n    </div>\n    <div>\n      Every hour from ${formatSpawnTime(item.time)} to ${formatSpawnTime(item.time + 900)}\n    </div>`\n\n  if (item.special) {\n    str += `\n      <div>\n        May appear as early as ${formatSpawnTime(item.time - 1800)}\n      </div>`\n  }\n  return str\n}\n\nfunction addRangeCircle (marker, map, type, teamId) {\n  var targetmap = null\n  var circleCenter = new google.maps.LatLng(marker.position.lat(), marker.position.lng())\n  var gymColors = ['#999999', '#0051CF', '#FF260E', '#FECC23'] // 'Uncontested', 'Mystic', 'Valor', 'Instinct']\n  var teamColor = gymColors[0]\n  if (teamId) teamColor = gymColors[teamId]\n\n  var range\n  var circleColor\n\n  // handle each type of marker and be explicit about the range circle attributes\n  switch (type) {\n    case 'pokemon':\n      circleColor = '#C233F2'\n      range = 40 // pokemon appear at 40m and then you can move away. still have to be 40m close to see it though, so ignore the further disappear distance\n      break\n    case 'pokestop':\n      circleColor = '#3EB0FF'\n      range = 40\n      break\n    case 'gym':\n      circleColor = teamColor\n      range = 40\n      break\n  }\n\n  if (map) targetmap = map\n\n  var rangeCircleOpts = {\n    map: targetmap,\n    radius: range, // meters\n    strokeWeight: 1,\n    strokeColor: circleColor,\n    strokeOpacity: 0.9,\n    center: circleCenter,\n    fillColor: circleColor,\n    fillOpacity: 0.3\n  }\n  var rangeCircle = new google.maps.Circle(rangeCircleOpts)\n  return rangeCircle\n}\n\nfunction isRangeActive (map) {\n  if (map.getZoom() < 16) return false\n  return Store.get('showRanges')\n}\n\nfunction customizePokemonMarker (marker, item, skipNotification) {\n  marker.addListener('click', function () {\n    this.setAnimation(null)\n    this.animationDisabled = true\n  })\n\n  if (!marker.rangeCircle && isRangeActive(map)) {\n    marker.rangeCircle = addRangeCircle(marker, map, 'pokemon')\n  }\n\n  marker.infoWindow = new google.maps.InfoWindow({\n    content: pokemonLabel(item['pokemon_name'], item['pokemon_rarity'], item['pokemon_types'], item['disappear_time'], item['pokemon_id'], item['latitude'], item['longitude'], item['encounter_id'], item['individual_attack'], item['individual_defense'], item['individual_stamina'], item['move_1'], item['move_2']),\n    disableAutoPan: true\n  })\n\n  if (notifiedPokemon.indexOf(item['pokemon_id']) > -1 || notifiedRarity.indexOf(item['pokemon_rarity']) > -1) {\n    if (!skipNotification) {\n      if (Store.get('playSound')) {\n        audio.play()\n      }\n      sendNotification('A wild ' + item['pokemon_name'] + ' appeared!', 'Click to load map', 'https://pokepro.co/wp-content/themes/html5blank-stable/static/icons/' + item['pokemon_id'] + '.png', item['latitude'], item['longitude'])\n    }\n    if (marker.animationDisabled !== true) {\n      marker.setAnimation(google.maps.Animation.BOUNCE)\n    }\n  }\n\n  if (item['individual_attack'] != null) {\n    var perfection = 100.0 * (item['individual_attack'] + item['individual_defense'] + item['individual_stamina']) / 45\n    if (notifiedMinPerfection > 0 && perfection >= notifiedMinPerfection) {\n      if (!skipNotification) {\n        if (Store.get('playSound')) {\n          audio.play()\n        }\n        sendNotification('A ' + perfection.toFixed(1) + '% perfect ' + item['pokemon_name'] + ' appeared!', 'Click to load map', 'https://pokepro.co/wp-content/themes/html5blank-stable/static/icons/' + item['pokemon_id'] + '.png', item['latitude'], item['longitude'])\n      }\n      if (marker.animationDisabled !== true) {\n        marker.setAnimation(google.maps.Animation.BOUNCE)\n      }\n    }\n  }\n\n  addListeners(marker)\n}\n\nfunction setupGymMarker (item) {\n  var marker = new google.maps.Marker({\n    position: {\n      lat: item['latitude'],\n      lng: item['longitude']\n    },\n    map: map,\n    icon: {url: 'https://pokepro.co/wp-content/themes/html5blank-stable/static/forts/' + Store.get('gymMarkerStyle') + '/' + gymTypes[item['team_id']] + (item['team_id'] !== 0 ? '_' + getGymLevel(item['gym_points']) : '') + '.png', scaledSize: new google.maps.Size(48, 48)}\n  })\n\n  if (!marker.rangeCircle && isRangeActive(map)) {\n    marker.rangeCircle = addRangeCircle(marker, map, 'gym', item['team_id'])\n  }\n\n  marker.infoWindow = new google.maps.InfoWindow({\n    content: gymLabel(gymTypes[item['team_id']], item['team_id'], item['gym_points'], item['latitude'], item['longitude'], item['last_scanned'], item['name'], item['pokemon'], item['gym_id']),\n    disableAutoPan: true\n  })\n\n  if (Store.get('useGymSidebar')) {\n    marker.addListener('click', function () {\n      var gymSidebar = document.querySelector('#gym-details')\n      if (gymSidebar.getAttribute('data-id') === item['gym_id'] && gymSidebar.classList.contains('visible')) {\n        gymSidebar.classList.remove('visible')\n      } else {\n        gymSidebar.setAttribute('data-id', item['gym_id'])\n        showGymDetails(item['gym_id'])\n      }\n    })\n\n    google.maps.event.addListener(marker.infoWindow, 'closeclick', function () {\n      marker.persist = null\n    })\n\n    marker.addListener('mouseover', function () {\n      marker.infoWindow.open(map, marker)\n      clearSelection()\n      updateLabelDiffTime()\n    })\n\n    marker.addListener('mouseout', function () {\n      if (!marker.persist) {\n        marker.infoWindow.close()\n      }\n    })\n  } else {\n    addListeners(marker)\n  }\n  return marker\n}\n\nfunction updateGymMarker (item, marker) {\n  marker.setIcon({url: 'https://pokepro.co/wp-content/themes/html5blank-stable/static/forts/' + Store.get('gymMarkerStyle') + '/' + gymTypes[item['team_id']] + (item['team_id'] !== 0 ? '_' + getGymLevel(item['gym_points']) : '') + '.png', scaledSize: new google.maps.Size(48, 48)})\n  marker.infoWindow.setContent(gymLabel(gymTypes[item['team_id']], item['team_id'], item['gym_points'], item['latitude'], item['longitude'], item['last_scanned'], item['name'], item['pokemon'], item['gym_id']))\n  return marker\n}\nfunction updateGymIcons () {\n  $.each(mapData.gyms, function (key, value) {\n    mapData.gyms[key]['marker'].setIcon({url: 'https://pokepro.co/wp-content/themes/html5blank-stable/static/forts/' + Store.get('gymMarkerStyle') + '/' + gymTypes[mapData.gyms[key]['team_id']] + (mapData.gyms[key]['team_id'] !== 0 ? '_' + getGymLevel(mapData.gyms[key]['gym_points']) : '') + '.png', scaledSize: new google.maps.Size(48, 48)})\n  })\n}\n\nfunction setupPokestopMarker (item) {\n  var imagename = item['lure_expiration'] ? 'PstopLured' : 'Pstop'\n  var marker = new google.maps.Marker({\n    position: {\n      lat: item['latitude'],\n      lng: item['longitude']\n    },\n    map: map,\n    zIndex: 2,\n    icon: 'https://pokepro.co/wp-content/themes/html5blank-stable/static/forts/' + imagename + '.png'\n  })\n\n  if (!marker.rangeCircle && isRangeActive(map)) {\n    marker.rangeCircle = addRangeCircle(marker, map, 'pokestop')\n  }\n\n  marker.infoWindow = new google.maps.InfoWindow({\n    content: pokestopLabel(item['lure_expiration'], item['latitude'], item['longitude']),\n    disableAutoPan: true\n  })\n\n  addListeners(marker)\n  return marker\n}\n\nfunction getColorByDate (value) {\n  // Changes the color from red to green over 15 mins\n  var diff = (Date.now() - value) / 1000 / 60 / 15\n\n  if (diff > 1) {\n    diff = 1\n  }\n\n  // value from 0 to 1 - Green to Red\n  var hue = ((1 - diff) * 120).toString(10)\n  return ['hsl(', hue, ',100%,50%)'].join('')\n}\n\nfunction setupScannedMarker (item) {\n  var circleCenter = new google.maps.LatLng(item['latitude'], item['longitude'])\n\n  var marker = new google.maps.Circle({\n    map: map,\n    clickable: false,\n    center: circleCenter,\n    radius: 70, // metres\n    fillColor: getColorByDate(item['last_modified']),\n    fillOpacity: 0.1,\n    strokeWeight: 1,\n    strokeOpacity: 0.5\n  })\n\n  return marker\n}\n\nfunction getColorBySpawnTime (value) {\n  var now = new Date()\n  var seconds = now.getMinutes() * 60 + now.getSeconds()\n\n  // account for hour roll-over\n  if (seconds < 900 && value > 2700) {\n    seconds += 3600\n  } else if (seconds > 2700 && value < 900) {\n    value += 3600\n  }\n\n  var diff = (seconds - value)\n  var hue = 275 // light purple when spawn is neither about to spawn nor active\n  if (diff >= 0 && diff <= 900) { // green to red over 15 minutes of active spawn\n    hue = (1 - (diff / 60 / 15)) * 120\n  } else if (diff < 0 && diff > -300) { // light blue to dark blue over 5 minutes til spawn\n    hue = ((1 - (-diff / 60 / 5)) * 50) + 200\n  }\n\n  hue = Math.round(hue / 5) * 5\n\n  return hue\n}\n\nfunction changeSpawnIcon (color, zoom) {\n  var urlColor = ''\n  if (color === 275) {\n    urlColor = './https://pokepro.co/wp-content/themes/html5blank-stable/static/icons/hsl-275-light.png'\n  } else {\n    urlColor = './https://pokepro.co/wp-content/themes/html5blank-stable/static/icons/hsl-' + color + '.png'\n  }\n  var zoomScale = 1.6 // adjust this value to change the size of the spawnpoint icons\n  var minimumSize = 1\n  var newSize = Math.round(zoomScale * (zoom - 10)) // this scales the icon based on zoom\n  if (newSize < minimumSize) {\n    newSize = minimumSize\n  }\n\n  var newIcon = {\n    url: urlColor,\n    scaledSize: new google.maps.Size(newSize, newSize),\n    anchor: new google.maps.Point(newSize / 2, newSize / 2)\n  }\n\n  return newIcon\n}\n\nfunction spawnPointIndex (color) {\n  var newIndex = 1\n  var scale = 0\n  if (color >= 0 && color <= 120) { // high to low over 15 minutes of active spawn\n    scale = color / 120\n    newIndex = 100 + scale * 100\n  } else if (color >= 200 && color <= 250) { // low to high over 5 minutes til spawn\n    scale = (color - 200) / 50\n    newIndex = scale * 100\n  }\n\n  return newIndex\n}\n\nfunction setupSpawnpointMarker (item) {\n  var circleCenter = new google.maps.LatLng(item['latitude'], item['longitude'])\n  var hue = getColorBySpawnTime(item.time)\n  var zoom = map.getZoom()\n\n  var marker = new google.maps.Marker({\n    map: map,\n    position: circleCenter,\n    icon: changeSpawnIcon(hue, zoom),\n    zIndex: spawnPointIndex(hue)\n  })\n\n  marker.infoWindow = new google.maps.InfoWindow({\n    content: spawnpointLabel(item),\n    disableAutoPan: true,\n    position: circleCenter\n  })\n\n  addListeners(marker)\n\n  return marker\n}\n\nfunction clearSelection () {\n  if (document.selection) {\n    document.selection.empty()\n  } else if (window.getSelection) {\n    window.getSelection().removeAllRanges()\n  }\n}\n\nfunction addListeners (marker) {\n  marker.addListener('click', function () {\n    if (!marker.infoWindowIsOpen) {\n      marker.infoWindow.open(map, marker)\n      clearSelection()\n      updateLabelDiffTime()\n      marker.persist = true\n      marker.infoWindowIsOpen = true\n    } else {\n      marker.persist = null\n      marker.infoWindow.close()\n      marker.infoWindowIsOpen = false\n    }\n  })\n\n  google.maps.event.addListener(marker.infoWindow, 'closeclick', function () {\n    marker.persist = null\n  })\n\n  marker.addListener('mouseover', function () {\n    marker.infoWindow.open(map, marker)\n    clearSelection()\n    updateLabelDiffTime()\n  })\n\n  marker.addListener('mouseout', function () {\n    if (!marker.persist) {\n      marker.infoWindow.close()\n    }\n  })\n\n  return marker\n}\n\nfunction clearStaleMarkers () {\n  $.each(mapData.pokemons, function (key, value) {\n    if (mapData.pokemons[key]['disappear_time'] < new Date().getTime() ||\n      excludedPokemon.indexOf(mapData.pokemons[key]['pokemon_id']) >= 0) {\n      if (mapData.pokemons[key].marker.rangeCircle) {\n        mapData.pokemons[key].marker.rangeCircle.setMap(null)\n        delete mapData.pokemons[key].marker.rangeCircle\n      }\n      mapData.pokemons[key].marker.setMap(null)\n      delete mapData.pokemons[key]\n    }\n  })\n\n  $.each(mapData.lurePokemons, function (key, value) {\n    if (mapData.lurePokemons[key]['lure_expiration'] < new Date().getTime() ||\n      excludedPokemon.indexOf(mapData.lurePokemons[key]['pokemon_id']) >= 0) {\n      mapData.lurePokemons[key].marker.setMap(null)\n      delete mapData.lurePokemons[key]\n    }\n  })\n\n  $.each(mapData.scanned, function (key, value) {\n    // If older than 15mins remove\n    if (mapData.scanned[key]['last_modified'] < (new Date().getTime() - 15 * 60 * 1000)) {\n      mapData.scanned[key].marker.setMap(null)\n      delete mapData.scanned[key]\n    }\n  })\n}\n\nfunction showInBoundsMarkers (markers, type) {\n  $.each(markers, function (key, value) {\n    var marker = markers[key].marker\n    var show = false\n    if (!markers[key].hidden) {\n      if (typeof marker.getBounds === 'function') {\n        if (map.getBounds().intersects(marker.getBounds())) {\n          show = true\n        }\n      } else if (typeof marker.getPosition === 'function') {\n        if (map.getBounds().contains(marker.getPosition())) {\n          show = true\n        }\n      }\n    }\n    // marker has an associated range\n    if (show && rangeMarkers.indexOf(type) !== -1) {\n      // no range circle yet...let's create one\n      if (!marker.rangeCircle) {\n        // but only if range is active\n        if (isRangeActive(map)) {\n          if (type === 'gym') marker.rangeCircle = addRangeCircle(marker, map, type, markers[key].team_id)\n          else marker.rangeCircle = addRangeCircle(marker, map, type)\n        }\n      } else { // there's already a range circle\n        if (isRangeActive(map)) {\n          marker.rangeCircle.setMap(map)\n        } else {\n          marker.rangeCircle.setMap(null)\n        }\n      }\n    }\n\n    if (show && !marker.getMap()) {\n      marker.setMap(map)\n      // Not all markers can be animated (ex: scan locations)\n      if (marker.setAnimation && marker.oldAnimation) {\n        marker.setAnimation(marker.oldAnimation)\n      }\n    } else if (!show && marker.getMap()) {\n      // Not all markers can be animated (ex: scan locations)\n      if (marker.getAnimation) {\n        marker.oldAnimation = marker.getAnimation()\n      }\n      if (marker.rangeCircle) marker.rangeCircle.setMap(null)\n      marker.setMap(null)\n    }\n  })\n}\n\nfunction loadRawData () {\n  var loadPokemon = Store.get('showPokemon')\n  var loadGyms = Store.get('showGyms')\n  var loadPokestops = Store.get('showPokestops')\n  var loadScanned = Store.get('showScanned')\n  var loadSpawnpoints = Store.get('showSpawnpoints')\n  var loadLuredOnly = Boolean(Store.get('showLuredPokestopsOnly'))\n\n  var bounds = map.getBounds()\n  var swPoint = bounds.getSouthWest()\n  var nePoint = bounds.getNorthEast()\n  var swLat = swPoint.lat()\n  var swLng = swPoint.lng()\n  var neLat = nePoint.lat()\n  var neLng = nePoint.lng()\n\n  return $.ajax({\n    url: 'raw_data.php',\n    type: 'GET',\n    data: {\n      'timestamp': timestamp,\n      'pokemon': loadPokemon,\n      'lastpokemon': lastpokemon,\n      'pokestops': loadPokestops,\n      'lastpokestops': lastpokestops,\n      'luredonly': loadLuredOnly,\n      'gyms': loadGyms,\n      'lastgyms': lastgyms,\n      'scanned': loadScanned,\n      'lastslocs': lastslocs,\n      'spawnpoints': loadSpawnpoints,\n      'lastspawns': lastspawns,\n      'swLat': swLat,\n      'swLng': swLng,\n      'neLat': neLat,\n      'neLng': neLng,\n      'oSwLat': oSwLat,\n      'oSwLng': oSwLng,\n      'oNeLat': oNeLat,\n      'oNeLng': oNeLng,\n      'reids': String(reincludedPokemon),\n      'eids': String(excludedPokemon)\n    },\n    dataType: 'json',\n    cache: false,\n    beforeSend: function () {\n      if (rawDataIsLoading) {\n        return false\n      } else {\n        rawDataIsLoading = true\n      }\n    },\n    complete: function () {\n      rawDataIsLoading = false\n    }\n  })\n}\n\nfunction processPokemons (i, item) {\n  if (!Store.get('showPokemon')) {\n    return false // in case the checkbox was unchecked in the meantime.\n  }\n\n  if (!(item['encounter_id'] in mapData.pokemons) &&\n    excludedPokemon.indexOf(item['pokemon_id']) < 0 && item['disappear_time'] > Date.now()) {\n    // add marker to map and item to dict\n    if (item.marker) {\n      item.marker.setMap(null)\n    }\n    if (!item.hidden) {\n      item.marker = setupPokemonMarker(item, map)\n      customizePokemonMarker(item.marker, item)\n      mapData.pokemons[item['encounter_id']] = item\n    }\n  }\n}\n\nfunction processPokestops (i, item) {\n  if (!Store.get('showPokestops')) {\n    return false\n  }\n\n  if (Store.get('showLuredPokestopsOnly') && !item['lure_expiration']) {\n    return true\n  }\n\n  if (!mapData.pokestops[item['pokestop_id']]) { // new pokestop, add marker to map and item to dict\n    if (item.marker && item.marker.rangeCircle) {\n      item.marker.rangeCircle.setMap(null)\n    }\n    if (item.marker) {\n      item.marker.setMap(null)\n    }\n    item.marker = setupPokestopMarker(item)\n    mapData.pokestops[item['pokestop_id']] = item\n  } else {  // change existing pokestop marker to unlured/lured\n    var item2 = mapData.pokestops[item['pokestop_id']]\n    if (!!item['lure_expiration'] !== !!item2['lure_expiration']) {\n      if (item2.marker && item2.marker.rangeCircle) {\n        item2.marker.rangeCircle.setMap(null)\n      }\n      item2.marker.setMap(null)\n      item.marker = setupPokestopMarker(item)\n      mapData.pokestops[item['pokestop_id']] = item\n    }\n  }\n}\n\nfunction updatePokestops () {\n  if (!Store.get('showPokestops')) {\n    return false\n  }\n\n  var removeStops = []\n  var currentTime = new Date().getTime()\n\n  // change lured pokestop marker to unlured when expired\n  $.each(mapData.pokestops, function (key, value) {\n    if (value['lure_expiration'] && value['lure_expiration'] < currentTime) {\n      value['lure_expiration'] = null\n      if (value.marker && value.marker.rangeCircle) {\n        value.marker.rangeCircle.setMap(null)\n      }\n      value.marker.setMap(null)\n      value.marker = setupPokestopMarker(value)\n    }\n  })\n\n  // remove unlured stops if show lured only is selected\n  if (Store.get('showLuredPokestopsOnly')) {\n    $.each(mapData.pokestops, function (key, value) {\n      if (!value['lure_expiration']) {\n        removeStops.push(key)\n      }\n    })\n    $.each(removeStops, function (key, value) {\n      if (mapData.pokestops[value] && mapData.pokestops[value].marker) {\n        if (mapData.pokestops[value].marker.rangeCircle) {\n          mapData.pokestops[value].marker.rangeCircle.setMap(null)\n        }\n        mapData.pokestops[value].marker.setMap(null)\n        delete mapData.pokestops[value]\n      }\n    })\n  }\n}\n\nfunction processGyms (i, item) {\n  if (!Store.get('showGyms')) {\n    return false // in case the checkbox was unchecked in the meantime.\n  }\n\n  if (item['gym_id'] in mapData.gyms) {\n    item.marker = updateGymMarker(item, mapData.gyms[item['gym_id']].marker)\n  } else { // add marker to map and item to dict\n    item.marker = setupGymMarker(item)\n  }\n  mapData.gyms[item['gym_id']] = item\n}\n\nfunction processScanned (i, item) {\n  if (!Store.get('showScanned')) {\n    return false\n  }\n\n  var scanId = item['latitude'] + '|' + item['longitude']\n\n  if (!(scanId in mapData.scanned)) { // add marker to map and item to dict\n    if (item.marker) {\n      item.marker.setMap(null)\n    }\n    item.marker = setupScannedMarker(item)\n    mapData.scanned[scanId] = item\n  } else {\n    mapData.scanned[scanId].last_modified = item['last_modified']\n  }\n}\n\nfunction updateScanned () {\n  if (!Store.get('showScanned')) {\n    return false\n  }\n\n  $.each(mapData.scanned, function (key, value) {\n    if (map.getBounds().intersects(value.marker.getBounds())) {\n      value.marker.setOptions({\n        fillColor: getColorByDate(value['last_modified'])\n      })\n    }\n  })\n}\n\nfunction processSpawnpoints (i, item) {\n  if (!Store.get('showSpawnpoints')) {\n    return false\n  }\n\n  var id = item['spawnpoint_id']\n\n  if (!(id in mapData.spawnpoints)) { // add marker to map and item to dict\n    if (item.marker) {\n      item.marker.setMap(null)\n    }\n    item.marker = setupSpawnpointMarker(item)\n    mapData.spawnpoints[id] = item\n  }\n}\n\nfunction updateSpawnPoints () {\n  if (!Store.get('showSpawnpoints')) {\n    return false\n  }\n\n  var zoom = map.getZoom()\n\n  $.each(mapData.spawnpoints, function (key, value) {\n    if (map.getBounds().contains(value.marker.getPosition())) {\n      var hue = getColorBySpawnTime(value['time'])\n      value.marker.setIcon(changeSpawnIcon(hue, zoom))\n      value.marker.setZIndex(spawnPointIndex(hue))\n    }\n  })\n}\n\nfunction updateMap () {\n  loadRawData().done(function (result) {\n    $.each(result.pokemons, processPokemons)\n    $.each(result.pokestops, processPokestops)\n    $.each(result.gyms, processGyms)\n    $.each(result.scanned, processScanned)\n    $.each(result.spawnpoints, processSpawnpoints)\n    showInBoundsMarkers(mapData.pokemons, 'pokemon')\n    showInBoundsMarkers(mapData.lurePokemons, 'pokemon')\n    showInBoundsMarkers(mapData.gyms, 'gym')\n    showInBoundsMarkers(mapData.pokestops, 'pokestop')\n    showInBoundsMarkers(mapData.scanned, 'scanned')\n    showInBoundsMarkers(mapData.spawnpoints, 'inbound')\n//    drawScanPath(result.scanned);\n    clearStaleMarkers()\n\n    updateScanned()\n    updateSpawnPoints()\n    updatePokestops()\n\n    if ($('#stats').hasClass('visible')) {\n      countMarkers(map)\n    }\n\n    oSwLat = result.oSwLat\n    oSwLng = result.oSwLng\n    oNeLat = result.oNeLat\n    oNeLng = result.oNeLng\n\n    lastgyms = result.lastgyms\n    lastpokestops = result.lastpokestops\n    lastpokemon = result.lastpokemon\n    lastslocs = result.lastslocs\n    lastspawns = result.lastspawns\n\n    reids = result.reids\n    if (reids instanceof Array) {\n      reincludedPokemon = reids.filter(function (e) { return this.indexOf(e) < 0 }, reincludedPokemon)\n    }\n    timestamp = result.timestamp\n    lastUpdateTime = Date.now()\n  })\n}\n\nfunction drawScanPath (points) { // eslint-disable-line no-unused-vars\n  var scanPathPoints = []\n  $.each(points, function (idx, point) {\n    scanPathPoints.push({lat: point['latitude'], lng: point['longitude']})\n  })\n  if (scanPath) {\n    scanPath.setMap(null)\n  }\n  scanPath = new google.maps.Polyline({\n    path: scanPathPoints,\n    geodesic: true,\n    strokeColor: '#FF0000',\n    strokeOpacity: 1.0,\n    strokeWeight: 2,\n    map: map\n  })\n}\n\nfunction redrawPokemon (pokemonList) {\n  var skipNotification = true\n  $.each(pokemonList, function (key, value) {\n    var item = pokemonList[key]\n    if (!item.hidden) {\n      if (item.marker.rangeCircle) item.marker.rangeCircle.setMap(null)\n      var newMarker = setupPokemonMarker(item, map, this.marker.animationDisabled)\n      customizePokemonMarker(newMarker, item, skipNotification)\n      item.marker.setMap(null)\n      pokemonList[key].marker = newMarker\n    }\n  })\n}\n\nvar updateLabelDiffTime = function () {\n  $('.label-countdown').each(function (index, element) {\n    var disappearsAt = new Date(parseInt(element.getAttribute('disappears-at')))\n    var now = new Date()\n\n    var difference = Math.abs(disappearsAt - now)\n    var hours = Math.floor(difference / 36e5)\n    var minutes = Math.floor((difference - (hours * 36e5)) / 6e4)\n    var seconds = Math.floor((difference - (hours * 36e5) - (minutes * 6e4)) / 1e3)\n    var timestring = ''\n\n    if (disappearsAt < now) {\n      timestring = '(expired)'\n    } else {\n      timestring = '('\n      if (hours > 0) {\n        timestring = hours + 'h'\n      }\n\n      timestring += ('0' + minutes).slice(-2) + 'm'\n      timestring += ('0' + seconds).slice(-2) + 's'\n      timestring += ')'\n    }\n\n    $(element).text(timestring)\n  })\n}\n\nfunction getPointDistance (pointA, pointB) {\n  return google.maps.geometry.spherical.computeDistanceBetween(pointA, pointB)\n}\n\nfunction sendNotification (title, text, icon, lat, lng) {\n  if (!('Notification' in window)) {\n    return false // Notifications are not present in browser\n  }\n\n  if (Notification.permission !== 'granted') {\n    Notification.requestPermission()\n  } else {\n    var notification = new Notification(title, {\n      icon: icon,\n      body: text,\n      sound: 'sounds/ding.mp3'\n    })\n\n    notification.onclick = function () {\n      window.focus()\n      notification.close()\n\n      centerMap(lat, lng, 20)\n    }\n  }\n}\n\nfunction createMyLocationButton () {\n  var locationContainer = document.createElement('div')\n\n  var locationButton = document.createElement('button')\n  locationButton.style.backgroundColor = '#fff'\n  locationButton.style.border = 'none'\n  locationButton.style.outline = 'none'\n  locationButton.style.width = '28px'\n  locationButton.style.height = '28px'\n  locationButton.style.borderRadius = '2px'\n  locationButton.style.boxShadow = '0 1px 4px rgba(0,0,0,0.3)'\n  locationButton.style.cursor = 'pointer'\n  locationButton.style.marginRight = '10px'\n  locationButton.style.padding = '0px'\n  locationButton.title = 'My Location'\n  locationContainer.appendChild(locationButton)\n\n  var locationIcon = document.createElement('div')\n  locationIcon.style.margin = '5px'\n  locationIcon.style.width = '18px'\n  locationIcon.style.height = '18px'\n  locationIcon.style.backgroundImage = 'url(https://pokepro.co/wp-content/themes/html5blank-stable/static/mylocation-sprite-1x.png)'\n  locationIcon.style.backgroundSize = '180px 18px'\n  locationIcon.style.backgroundPosition = '0px 0px'\n  locationIcon.style.backgroundRepeat = 'no-repeat'\n  locationIcon.id = 'current-location'\n  locationButton.appendChild(locationIcon)\n\n  locationButton.addEventListener('click', function () {\n    centerMapOnLocation()\n  })\n\n  locationContainer.index = 1\n  map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(locationContainer)\n\n  google.maps.event.addListener(map, 'dragend', function () {\n    var currentLocation = document.getElementById('current-location')\n    currentLocation.style.backgroundPosition = '0px 0px'\n  })\n}\n\nfunction centerMapOnLocation () {\n  var currentLocation = document.getElementById('current-location')\n  var imgX = '0'\n  var animationInterval = setInterval(function () {\n    if (imgX === '-18') {\n      imgX = '0'\n    } else {\n      imgX = '-18'\n    }\n    currentLocation.style.backgroundPosition = imgX + 'px 0'\n  }, 500)\n  if (navigator.geolocation) {\n    navigator.geolocation.getCurrentPosition(function (position) {\n      var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude)\n      locationMarker.setPosition(latlng)\n      map.setCenter(latlng)\n      Store.set('followMyLocationPosition', { lat: position.coords.latitude, lng: position.coords.longitude })\n      clearInterval(animationInterval)\n      currentLocation.style.backgroundPosition = '-144px 0px'\n    })\n  } else {\n    clearInterval(animationInterval)\n    currentLocation.style.backgroundPosition = '0px 0px'\n  }\n}\n\nfunction changeLocation (lat, lng) {\n  var loc = new google.maps.LatLng(lat, lng)\n  changeSearchLocation(lat, lng).done(function () {\n    map.setCenter(loc)\n    searchMarker.setPosition(loc)\n  })\n}\n\nfunction changeSearchLocation (lat, lng) {\n  return $.post('next_loc?lat=' + lat + '&lon=' + lng, {})\n}\n\nfunction centerMap (lat, lng, zoom) {\n  var loc = new google.maps.LatLng(lat, lng)\n\n  map.setCenter(loc)\n\n  if (zoom) {\n    storeZoom = false\n    map.setZoom(zoom)\n  }\n}\n\nfunction i8ln (word) {\n  if ($.isEmptyObject(i8lnDictionary) && language !== 'en' && languageLookups < languageLookupThreshold) {\n    $.ajax({\n      url: 'https://pokepro.co/wp-content/themes/html5blank-stable/static/dist/locales/' + language + '.min.json',\n      dataType: 'json',\n      async: false,\n      success: function (data) {\n        i8lnDictionary = data\n      },\n      error: function (jqXHR, status, error) {\n        console.log('Error loading i8ln dictionary: ' + error)\n        languageLookups++\n      }\n    })\n  }\n  if (word in i8lnDictionary) {\n    return i8lnDictionary[word]\n  } else {\n    // Word doesn't exist in dictionary return it as is\n    return word\n  }\n}\n\nfunction updateGeoLocation () {\n  if (navigator.geolocation && (Store.get('geoLocate') || Store.get('followMyLocation'))) {\n    navigator.geolocation.getCurrentPosition(function (position) {\n      var lat = position.coords.latitude\n      var lng = position.coords.longitude\n      var center = new google.maps.LatLng(lat, lng)\n\n      if (Store.get('geoLocate')) {\n        // the search function makes any small movements cause a loop. Need to increase resolution\n        if ((typeof searchMarker !== 'undefined') && (getPointDistance(searchMarker.getPosition(), center) > 40)) {\n          $.post('next_loc?lat=' + lat + '&lon=' + lng).done(function () {\n            map.panTo(center)\n            searchMarker.setPosition(center)\n          })\n        }\n      }\n      if (Store.get('followMyLocation')) {\n        if ((typeof locationMarker !== 'undefined') && (getPointDistance(locationMarker.getPosition(), center) >= 5)) {\n          map.panTo(center)\n          locationMarker.setPosition(center)\n          Store.set('followMyLocationPosition', { lat: lat, lng: lng })\n        }\n      }\n    })\n  }\n}\n\nfunction createUpdateWorker () {\n  try {\n    if (isMobileDevice() && (window.Worker)) {\n      var updateBlob = new Blob([`onmessage = function(e) {\n        var data = e.data\n        if (data.name === 'backgroundUpdate') {\n          self.setInterval(function () {self.postMessage({name: 'backgroundUpdate'})}, 5000)\n        }\n      }`])\n\n      var updateBlobURL = window.URL.createObjectURL(updateBlob)\n\n      updateWorker = new Worker(updateBlobURL)\n\n      updateWorker.onmessage = function (e) {\n        var data = e.data\n        if (document.hidden && data.name === 'backgroundUpdate' && Date.now() - lastUpdateTime > 2500) {\n          updateMap()\n          updateGeoLocation()\n        }\n      }\n\n      updateWorker.postMessage({name: 'backgroundUpdate'})\n    }\n  } catch (ex) {\n    console.log('Webworker error: ' + ex.message)\n  }\n}\n\nfunction showGymDetails (id) { // eslint-disable-line no-unused-vars\n  var sidebar = document.querySelector('#gym-details')\n  var sidebarClose\n\n  sidebar.classList.add('visible')\n\n  var data = $.ajax({\n    url: 'gym_data',\n    type: 'GET',\n    data: {\n      'id': id\n    },\n    dataType: 'json',\n    cache: false\n  })\n\n  data.done(function (result) {\n    var gymLevel = getGymLevel(result.gym_points)\n    var nextLvlPrestige = gymPrestige[gymLevel - 1] || 50000\n    var prestigePercentage = (result.gym_points / nextLvlPrestige) * 100\n    var lastScannedDate = new Date(result.last_scanned)\n    var freeSlots = result.pokemon.length ? gymLevel - result.pokemon.length : 0\n    var freeSlotsStr = freeSlots ? ` - ${freeSlots} Free Slots` : ''\n    var gymLevelStr = ''\n\n    if (result.team_id === 0) {\n      gymLevelStr = `\n        <center class=\"team-${result.team_id}-text\">\n          <b class=\"team-${result.team_id}-text\">Uncontested - 1 Free Slot</b>\n        </center>`\n    } else {\n      gymLevelStr = `<div>\n        <b class=\"team-${result.team_id}-text\">Level ${gymLevel}${freeSlotsStr}</b>\n      </div>`\n    }\n    var pokemonHtml = ''\n    var headerHtml = `\n      <center class=\"team-${result.team_id}-text\">\n        <div>\n          <b class=\"team-${result.team_id}-text\">${result.name || ''}</b>\n        </div>\n        <img height=\"100px\" style=\"padding: 5px;\" src=\"https://pokepro.co/wp-content/themes/html5blank-stable/static/forts/${gymTypes[result.team_id]}_large.png\">\n        <div class=\"prestige-bar team-${result.team_id}\">\n          <div class=\"prestige team-${result.team_id}\" style=\"width: ${prestigePercentage}%\">\n          </div>\n        </div>\n        <div>\n          ${result.gym_points}/${nextLvlPrestige}\n        </div>\n        ${gymLevelStr}\n        <div style=\"font-size: .7em;\">\n          Last Scanned: ${lastScannedDate.getFullYear()}-${pad(lastScannedDate.getMonth() + 1)}-${pad(lastScannedDate.getDate())} ${pad(lastScannedDate.getHours())}:${pad(lastScannedDate.getMinutes())}:${pad(lastScannedDate.getSeconds())}\n        </div>\n        <div>\n          <a href='javascript:void(0);' onclick='javascript:openMapDirections(${result.latitude},${result.longitude});' title='View in Maps'>Get directions</a>\n        </div>\n      </center>\n    `\n\n    if (result.pokemon.length) {\n      $.each(result.pokemon, function (i, pokemon) {\n        var perfectPercent = Math.round((pokemon.iv_defense + pokemon.iv_attack + pokemon.iv_stamina) * 100 / 45)\n        var moveEnergy = Math.round(100 / pokemon.move_2_energy)\n\n        pokemonHtml += `\n          <tr onclick=toggleGymPokemonDetails(this)>\n            <td width=\"30px\">\n              <i class=\"pokemon-sprite n${pokemon.pokemon_id}\"></i>\n            </td>\n            <td class=\"team-${result.team_id}-text\">\n              <div style=\"line-height:1em;\">${pokemon.pokemon_name}</div>\n              <div class=\"cp\">CP ${pokemon.pokemon_cp}</div>\n            </td>\n            <td width=\"190\" class=\"team-${result.team_id}-text\" align=\"center\">\n              <div class=\"trainer-level\">${pokemon.trainer_level}</div>\n              <div style=\"line-height: 1em;\">${pokemon.trainer_name}</div>\n            </td>\n            <td width=\"10\">\n              <!--<a href=\"#\" onclick=\"toggleGymPokemonDetails(this)\">-->\n                <i class=\"team-${result.team_id}-text fa fa-angle-double-down\"></i>\n              <!--</a>-->\n            </td>\n          </tr>\n          <tr class=\"details\">\n            <td colspan=\"2\">\n              <div class=\"ivs\">\n                <div class=\"iv\">\n                  <div class=\"type\">ATK</div>\n                  <div class=\"value\">\n                    ${pokemon.iv_attack}\n                  </div>\n                </div>\n                <div class=\"iv\">\n                  <div class=\"type\">DEF</div>\n                  <div class=\"value\">\n                    ${pokemon.iv_defense}\n                  </div>\n                </div>\n                <div class=\"iv\">\n                  <div class=\"type\">STA</div>\n                  <div class=\"value\">\n                    ${pokemon.iv_stamina}\n                  </div>\n                </div>\n                <div class=\"iv\" style=\"width: 36px;\"\">\n                  <div class=\"type\">PERFECT</div>\n                  <div class=\"value\">\n                    ${perfectPercent}<span style=\"font-size: .6em;\">%</span>\n                  </div>\n                </div>\n              </div>\n            </td>\n            <td colspan=\"2\">\n              <div class=\"moves\">\n                <div class=\"move\">\n                  <div class=\"name\">\n                    ${pokemon.move_1_name}\n                    <div class=\"type ${pokemon.move_1_type.toLowerCase()}\">${pokemon.move_1_type}</div>\n                  </div>\n                  <div class=\"damage\">\n                    ${pokemon.move_1_damage}\n                  </div>\n                </div>\n                <br>\n                <div class=\"move\">\n                  <div class=\"name\">\n                    ${pokemon.move_2_name}\n                    <div class=\"type ${pokemon.move_2_type.toLowerCase()}\">${pokemon.move_2_type}</div>\n                    <div>\n                      <i class=\"move-bar-sprite move-bar-sprite-${moveEnergy}\"></i>\n                    </div>\n                  </div>\n                  <div class=\"damage\">\n                    ${pokemon.move_2_damage}\n                  </div>\n                </div>\n              </div>\n            </td>\n          </tr>\n          `\n      })\n\n      pokemonHtml = `<table><tbody>${pokemonHtml}</tbody></table>`\n    } else if (result.team_id === 0) {\n      pokemonHtml = ''\n    } else {\n      pokemonHtml = `\n        <center class=\"team-${result.team_id}-text\">\n          Gym Leader:<br>\n          <i class=\"pokemon-large-sprite n${result.guard_pokemon_id}\"></i><br>\n          <b class=\"team-${result.team_id}-text\">${result.guard_pokemon_name}</b>\n\n          <p style=\"font-size: .75em; margin: 5px;\">\n            No additional gym information is available for this gym. Make sure you are collecting <a href=\"https://pgm.readthedocs.io/en/develop/extras/gyminfo.html\">detailed gym info.</a>\n            If you have detailed gym info collection running, this gym's Pokemon information may be out of date.\n          </p>\n        </center>\n      `\n    }\n\n    sidebar.innerHTML = `${headerHtml}${pokemonHtml}`\n\n    sidebarClose = document.createElement('a')\n    sidebarClose.href = '#'\n    sidebarClose.className = 'close'\n    sidebarClose.tabIndex = 0\n    sidebar.appendChild(sidebarClose)\n\n    sidebarClose.addEventListener('click', function (event) {\n      event.preventDefault()\n      event.stopPropagation()\n      sidebar.classList.remove('visible')\n    })\n  })\n}\n\nfunction toggleGymPokemonDetails (e) { // eslint-disable-line no-unused-vars\n  e.lastElementChild.firstElementChild.classList.toggle('fa-angle-double-up')\n  e.lastElementChild.firstElementChild.classList.toggle('fa-angle-double-down')\n  e.nextElementSibling.classList.toggle('visible')\n}\n\n//\n// Page Ready Exection\n//\n\n$(function () {\n  if (!Notification) {\n    console.log('could not load notifications')\n    return\n  }\n\n  if (Notification.permission !== 'granted') {\n    Notification.requestPermission()\n  }\n})\n\n$(function () {\n  // populate Navbar Style menu\n  $selectStyle = $('#map-style')\n\n  // Load Stylenames, translate entries, and populate lists\n  $.getJSON('https://pokepro.co/wp-content/themes/html5blank-stable/static/dist/data/mapstyle.min.json').done(function (data) {\n    var styleList = []\n\n    $.each(data, function (key, value) {\n      styleList.push({\n        id: key,\n        text: i8ln(value)\n      })\n    })\n\n    // setup the stylelist\n    $selectStyle.select2({\n      placeholder: 'Select Style',\n      data: styleList,\n      minimumResultsForSearch: Infinity\n    })\n\n    // setup the list change behavior\n    $selectStyle.on('change', function (e) {\n      selectedStyle = $selectStyle.val()\n      map.setMapTypeId(selectedStyle)\n      Store.set('map_style', selectedStyle)\n    })\n\n    // recall saved mapstyle\n    $selectStyle.val(Store.get('map_style')).trigger('change')\n  })\n\n  $selectIconResolution = $('#pokemon-icons')\n\n  $selectIconResolution.select2({\n    placeholder: 'Select Icon Resolution',\n    minimumResultsForSearch: Infinity\n  })\n\n  $selectIconResolution.on('change', function () {\n    Store.set('pokemonIcons', this.value)\n    redrawPokemon(mapData.pokemons)\n    redrawPokemon(mapData.lurePokemons)\n  })\n\n  $selectIconSize = $('#pokemon-icon-size')\n\n  $selectIconSize.select2({\n    placeholder: 'Select Icon Size',\n    minimumResultsForSearch: Infinity\n  })\n\n  $selectIconSize.on('change', function () {\n    Store.set('iconSizeModifier', this.value)\n    redrawPokemon(mapData.pokemons)\n    redrawPokemon(mapData.lurePokemons)\n  })\n\n  $selectLuredPokestopsOnly = $('#lured-pokestops-only-switch')\n\n  $selectLuredPokestopsOnly.select2({\n    placeholder: 'Only Show Lured Pokestops',\n    minimumResultsForSearch: Infinity\n  })\n\n  $selectLuredPokestopsOnly.on('change', function () {\n    Store.set('showLuredPokestopsOnly', this.value)\n    lastpokestops = false\n    updateMap()\n  })\n  $switchGymSidebar = $('#gym-sidebar-switch')\n\n  $switchGymSidebar.on('change', function () {\n    Store.set('useGymSidebar', this.checked)\n    lastgyms = false\n    $.each(['gyms'], function (d, dType) {\n      $.each(mapData[dType], function (key, value) {\n        // for any marker you're turning off, you'll want to wipe off the range\n        if (mapData[dType][key].marker.rangeCircle) {\n          mapData[dType][key].marker.rangeCircle.setMap(null)\n          delete mapData[dType][key].marker.rangeCircle\n        }\n        mapData[dType][key].marker.setMap(null)\n      })\n      mapData[dType] = {}\n    })\n    updateMap()\n  })\n\n  $selectSearchIconMarker = $('#iconmarker-style')\n  $selectLocationIconMarker = $('#locationmarker-style')\n\n  $.getJSON('https://pokepro.co/wp-content/themes/html5blank-stable/static/dist/data/searchmarkerstyle.min.json').done(function (data) {\n    searchMarkerStyles = data\n    var searchMarkerStyleList = []\n\n    $.each(data, function (key, value) {\n      searchMarkerStyleList.push({\n        id: key,\n        text: value.name\n      })\n    })\n\n    $selectSearchIconMarker.select2({\n      placeholder: 'Select Icon Marker',\n      data: searchMarkerStyleList,\n      minimumResultsForSearch: Infinity\n    })\n\n    $selectSearchIconMarker.on('change', function (e) {\n      var selectSearchIconMarker = $selectSearchIconMarker.val()\n      Store.set('searchMarkerStyle', selectSearchIconMarker)\n      updateSearchMarker(selectSearchIconMarker)\n    })\n\n    $selectSearchIconMarker.val(Store.get('searchMarkerStyle')).trigger('change')\n\n    updateSearchMarker(Store.get('lockMarker'))\n\n    $selectLocationIconMarker.select2({\n      placeholder: 'Select Location Marker',\n      data: searchMarkerStyleList,\n      minimumResultsForSearch: Infinity\n    })\n\n    $selectLocationIconMarker.on('change', function (e) {\n      Store.set('locationMarkerStyle', this.value)\n      updateLocationMarker(this.value)\n    })\n\n    $selectLocationIconMarker.val(Store.get('locationMarkerStyle')).trigger('change')\n  })\n\n  $selectGymMarkerStyle = $('#gym-marker-style')\n\n  $selectGymMarkerStyle.select2({\n    placeholder: 'Select Style',\n    minimumResultsForSearch: Infinity\n  })\n\n  $selectGymMarkerStyle.on('change', function (e) {\n    Store.set('gymMarkerStyle', this.value)\n    updateGymIcons()\n  })\n\n  $selectGymMarkerStyle.val(Store.get('gymMarkerStyle')).trigger('change')\n})\n\n$(function () {\n  function formatState (state) {\n    if (!state.id) {\n      return state.text\n    }\n    var $state = $(\n      '<span><i class=\"pokemon-sprite n' + state.element.value.toString() + '\"></i> ' + state.text + '</span>'\n    )\n    return $state\n  }\n\n  if (Store.get('startAtUserLocation')) {\n    centerMapOnLocation()\n  }\n\n  $.getJSON('https://pokepro.co/wp-content/themes/html5blank-stable/static/dist/data/moves.min.json').done(function (data) {\n    moves = data\n  })\n\n  $selectExclude = $('#exclude-pokemon')\n  $selectPokemonNotify = $('#notify-pokemon')\n  $selectRarityNotify = $('#notify-rarity')\n  $textPerfectionNotify = $('#notify-perfection')\n  var numberOfPokemon = 151\n\n  // Load pokemon names and populate lists\n  $.getJSON('https://pokepro.co/wp-content/themes/html5blank-stable/static/dist/data/pokemon.min.json').done(function (data) {\n    var pokeList = []\n\n    $.each(data, function (key, value) {\n      if (key > numberOfPokemon) {\n        return false\n      }\n      var _types = []\n      pokeList.push({\n        id: key,\n        text: i8ln(value['name']) + ' - #' + key\n      })\n      value['name'] = i8ln(value['name'])\n      value['rarity'] = i8ln(value['rarity'])\n      $.each(value['types'], function (key, pokemonType) {\n        _types.push({\n          'type': i8ln(pokemonType['type']),\n          'color': pokemonType['color']\n        })\n      })\n      value['types'] = _types\n      idToPokemon[key] = value\n    })\n\n    // setup the filter lists\n    $selectExclude.select2({\n      placeholder: i8ln('Select Pokémon'),\n      data: pokeList,\n      templateResult: formatState\n    })\n    $selectPokemonNotify.select2({\n      placeholder: i8ln('Select Pokémon'),\n      data: pokeList,\n      templateResult: formatState\n    })\n    $selectRarityNotify.select2({\n      placeholder: i8ln('Select Rarity'),\n      data: [i8ln('Common'), i8ln('Uncommon'), i8ln('Rare'), i8ln('Very Rare'), i8ln('Ultra Rare')],\n      templateResult: formatState\n    })\n\n    // setup list change behavior now that we have the list to work from\n    $selectExclude.on('change', function (e) {\n      buffer = excludedPokemon\n      excludedPokemon = $selectExclude.val().map(Number)\n      buffer = buffer.filter(function (e) { return this.indexOf(e) < 0 }, excludedPokemon)\n      reincludedPokemon = reincludedPokemon.concat(buffer)\n      clearStaleMarkers()\n      Store.set('remember_select_exclude', excludedPokemon)\n    })\n    $selectPokemonNotify.on('change', function (e) {\n      notifiedPokemon = $selectPokemonNotify.val().map(Number)\n      Store.set('remember_select_notify', notifiedPokemon)\n    })\n    $selectRarityNotify.on('change', function (e) {\n      notifiedRarity = $selectRarityNotify.val().map(String)\n      Store.set('remember_select_rarity_notify', notifiedRarity)\n    })\n    $textPerfectionNotify.on('change', function (e) {\n      notifiedMinPerfection = parseInt($textPerfectionNotify.val(), 10)\n      if (isNaN(notifiedMinPerfection) || notifiedMinPerfection <= 0) {\n        notifiedMinPerfection = ''\n      }\n      if (notifiedMinPerfection > 100) {\n        notifiedMinPerfection = 100\n      }\n      $textPerfectionNotify.val(notifiedMinPerfection)\n      Store.set('remember_text_perfection_notify', notifiedMinPerfection)\n    })\n\n    // recall saved lists\n    $selectExclude.val(Store.get('remember_select_exclude')).trigger('change')\n    $selectPokemonNotify.val(Store.get('remember_select_notify')).trigger('change')\n    $selectRarityNotify.val(Store.get('remember_select_rarity_notify')).trigger('change')\n    $textPerfectionNotify.val(Store.get('remember_text_perfection_notify')).trigger('change')\n\n    if (isTouchDevice() && isMobileDevice()) {\n      $('.select2-search input').prop('readonly', true)\n    }\n  })\n\n  // run interval timers to regularly update map and timediffs\n  window.setInterval(updateLabelDiffTime, 1000)\n  window.setInterval(updateMap, 5000)\n  window.setInterval(updateGeoLocation, 1000)\n\n  createUpdateWorker()\n\n  // Wipe off/restore map icons when switches are toggled\n  function buildSwitchChangeListener (data, dataType, storageKey) {\n    return function () {\n      Store.set(storageKey, this.checked)\n      if (this.checked) {\n        // When switch is turned on we asume it has been off, makes sure we dont end up in limbo\n        // Without this there could've been a situation where no markers are on map and only newly modified ones are loaded\n        if (storageKey === 'showPokemon') {\n          lastpokemon = false\n        } else if (storageKey === 'showGyms') {\n          lastgyms = false\n        } else if (storageKey === 'showPokestops') {\n          lastpokestops = false\n        } else if (storageKey === 'showScanned') {\n          lastslocs = false\n        } else if (storageKey === 'showSpawnpoints') {\n          lastspawns = false\n        }\n        updateMap()\n      } else {\n        $.each(dataType, function (d, dType) {\n          $.each(data[dType], function (key, value) {\n            // for any marker you're turning off, you'll want to wipe off the range\n            if (data[dType][key].marker.rangeCircle) {\n              data[dType][key].marker.rangeCircle.setMap(null)\n              delete data[dType][key].marker.rangeCircle\n            }\n            if (storageKey !== 'showRanges') data[dType][key].marker.setMap(null)\n          })\n          if (storageKey !== 'showRanges') data[dType] = {}\n        })\n        if (storageKey === 'showRanges') {\n          updateMap()\n        }\n      }\n    }\n  }\n\n  // Setup UI element interactions\n  $('#gyms-switch').change(function () {\n    var options = {\n      'duration': 500\n    }\n    var wrapper = $('#gym-sidebar-wrapper')\n    if (this.checked) {\n      lastgyms = false\n      wrapper.show(options)\n    } else {\n      lastgyms = false\n      wrapper.hide(options)\n    }\n    buildSwitchChangeListener(mapData, ['gyms'], 'showGyms').bind(this)()\n  })\n  $('#pokemon-switch').change(function () {\n    buildSwitchChangeListener(mapData, ['pokemons'], 'showPokemon').bind(this)()\n  })\n  $('#scanned-switch').change(function () {\n    buildSwitchChangeListener(mapData, ['scanned'], 'showScanned').bind(this)()\n  })\n  $('#spawnpoints-switch').change(function () {\n    buildSwitchChangeListener(mapData, ['spawnpoints'], 'showSpawnpoints').bind(this)()\n  })\n  $('#ranges-switch').change(buildSwitchChangeListener(mapData, ['gyms', 'pokemons', 'pokestops'], 'showRanges'))\n\n  $('#pokestops-switch').change(function () {\n    var options = {\n      'duration': 500\n    }\n    var wrapper = $('#lured-pokestops-only-wrapper')\n    if (this.checked) {\n      lastpokestops = false\n      wrapper.show(options)\n    } else {\n      lastpokestops = false\n      wrapper.hide(options)\n    }\n    return buildSwitchChangeListener(mapData, ['pokestops'], 'showPokestops').bind(this)()\n  })\n\n  $('#sound-switch').change(function () {\n    Store.set('playSound', this.checked)\n  })\n\n  $('#geoloc-switch').change(function () {\n    $('#next-location').prop('disabled', this.checked)\n    $('#next-location').css('background-color', this.checked ? '#e0e0e0' : '#ffffff')\n    if (!navigator.geolocation) {\n      this.checked = false\n    } else {\n      Store.set('geoLocate', this.checked)\n    }\n  })\n\n  $('#lock-marker-switch').change(function () {\n    Store.set('lockMarker', this.checked)\n    searchMarker.setDraggable(!this.checked)\n  })\n\n  $('#search-switch').change(function () {\n    searchControl(this.checked ? 'on' : 'off')\n  })\n\n  $('#start-at-user-location-switch').change(function () {\n    Store.set('startAtUserLocation', this.checked)\n  })\n\n  $('#follow-my-location-switch').change(function () {\n    if (!navigator.geolocation) {\n      this.checked = false\n    } else {\n      Store.set('followMyLocation', this.checked)\n    }\n    locationMarker.setDraggable(!this.checked)\n  })\n\n  $('#scan-here-switch').change(function () {\n    if (this.checked && !Store.get('scanHereAlerted')) {\n      alert('Use this feature carefully ! This button will set the current map center as new search location. This may cause worker to teleport long range.')\n      Store.set('scanHereAlerted', true)\n    }\n    $('#scan-here').toggle(this.checked)\n    Store.set('scanHere', this.checked)\n  })\n\n  if ($('#nav-accordion').length) {\n    $('#nav-accordion').accordion({\n      active: 0,\n      collapsible: true,\n      heightStyle: 'content'\n    })\n  }\n\n  // Initialize dataTable in statistics sidebar\n  //   - turn off sorting for the 'icon' column\n  //   - initially sort 'name' column alphabetically\n\n  $('#pokemonList_table').DataTable({\n    paging: false,\n    searching: false,\n    info: false,\n    errMode: 'throw',\n    'language': {\n      'emptyTable': ''\n    },\n    'columns': [\n      { 'orderable': false },\n      null,\n      null,\n      null\n    ]\n  }).order([1, 'asc'])\n})\n"]}